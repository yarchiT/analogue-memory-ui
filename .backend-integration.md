# Analogue Memory API Documentation

Integrate with the backend API
# Frontend Integration Guide - Analogue Memory

## Overview
This guide outlines how to integrate the React frontend with the Node.js backend API. Follow these instructions to ensure proper connectivity between the two systems.

## API Connection Setup

### Environment Configuration
1. Create a `.env` file in your project root with the following variables:
   ```
   REACT_APP_API_URL=http://localhost:3000/api
   REACT_APP_ASSET_URL=http://localhost:3000/assets
   ```

2. Configure different environments in your Cloudflare Pages setup:
   - Development: `API_URL=http://localhost:3000/api`
   - Production: `API_URL=https://api.analoguememory.com/api`


## API Integration Checklist

### Phase 1: Mock Data Integration
- [ ] Create service functions that call mock endpoints
- [ ] Implement error handling for API requests
- [ ] Add loading states for API calls
- [ ] Test connectivity with local backend server

### Phase 2: Authentication Integration
- [ ] Implement login API call with JWT token storage
- [ ] Add registration API integration
- [ ] Create token refresh mechanism
- [ ] Test authentication flow end-to-end

### Phase 3: Memory Items Integration
- [ ] Connect category browsing to API endpoints
- [ ] Implement search functionality with API
- [ ] Add item detail fetching from API
- [ ] Implement proper image loading from backend

### Phase 4: User Collection Integration
- [ ] Add "add to collection" API calls
- [ ] Implement collection fetching from API
- [ ] Create personal notes API integration
- [ ] Add collection management (remove items, etc.)

### Phase 5: Comparison Feature Integration
- [ ] Implement user search via API
- [ ] Connect comparison calculation to API
- [ ] Add similarity visualizations using API data
- [ ] Implement recommendation features from API


## Base URL
```
http://localhost:3000
```

## Health Check

### Check API Status
```
GET /health
```

**Response:**
```json
{
  "status": "success",
  "message": "API is running",
  "timestamp": "2025-03-09T11:51:48.898Z",
  "environment": "development"
}
```

## Categories

### Get All Categories
```
GET /api/categories
```

**Response:**
```json
{
  "status": "success",
  "results": 7,
  "data": {
    "categories": [
      {
        "id": "cat-001",
        "name": "Video Games",
        "description": "Console and PC games from the 90s and 2000s",
        "imageUrl": "https://example.com/images/categories/video-games.jpg"
      },
      {
        "id": "cat-002",
        "name": "Toys",
        "description": "Popular toys and action figures from the 90s and 2000s",
        "imageUrl": "https://example.com/images/categories/toys.jpg"
      },
      // Additional categories...
    ]
  }
}
```

### Get Category by ID
```
GET /api/categories/:id
```

**Parameters:**
- `id` - The ID of the category to retrieve

**Response:**
```json
{
  "status": "success",
  "data": {
    "category": {
      "id": "cat-001",
      "name": "Video Games",
      "description": "Console and PC games from the 90s and 2000s",
      "imageUrl": "https://example.com/images/categories/video-games.jpg"
    }
  }
}
```

## Memory Items

### Get All Items
```
GET /api/items
```

**Response:**
```json
{
  "status": "success",
  "results": 20,
  "data": {
    "items": [
      {
        "id": "vg-001",
        "name": "Super Mario 64",
        "description": "A 1996 platform game for the Nintendo 64 and the first Super Mario game to feature 3D gameplay.",
        "category": "cat-001",
        "decade": "1990s",
        "year": 1996,
        "imageUrl": "https://example.com/images/items/super-mario-64.jpg",
        "popularity": 95,
        "tags": ["Nintendo", "Platform", "Mario", "N64"]
      },
      // Additional items...
    ]
  }
}
```

### Get Item by ID
```
GET /api/items/:id
```

**Parameters:**
- `id` - The ID of the item to retrieve

**Response:**
```json
{
  "status": "success",
  "data": {
    "item": {
      "id": "vg-001",
      "name": "Super Mario 64",
      "description": "A 1996 platform game for the Nintendo 64 and the first Super Mario game to feature 3D gameplay.",
      "category": "cat-001",
      "decade": "1990s",
      "year": 1996,
      "imageUrl": "https://example.com/images/items/super-mario-64.jpg",
      "popularity": 95,
      "tags": ["Nintendo", "Platform", "Mario", "N64"]
    }
  }
}
```

### Search Items
```
GET /api/items/search?query=:searchTerm
```

**Parameters:**
- `query` - The search term to filter items by name, description, or tags

**Response:**
```json
{
  "status": "success",
  "results": 4,
  "data": {
    "items": [
      {
        "id": "vg-001",
        "name": "Super Mario 64",
        "description": "A 1996 platform game for the Nintendo 64 and the first Super Mario game to feature 3D gameplay.",
        "category": "cat-001",
        "decade": "1990s",
        "year": 1996,
        "imageUrl": "https://example.com/images/items/super-mario-64.jpg",
        "popularity": 95,
        "tags": ["Nintendo", "Platform", "Mario", "N64"]
      },
      // Additional matching items...
    ]
  }
}
```

### Get Items by Category
```
GET /api/items/category/:categoryId
```

**Parameters:**
- `categoryId` - The ID of the category to filter items by

**Response:**
```json
{
  "status": "success",
  "results": 10,
  "data": {
    "items": [
      {
        "id": "toy-001",
        "name": "Tamagotchi",
        "description": "A handheld digital pet created in Japan by Bandai in 1996, one of the biggest toy fads of the late 1990s.",
        "category": "cat-002",
        "decade": "1990s",
        "year": 1996,
        "imageUrl": "https://example.com/images/items/tamagotchi.jpg",
        "popularity": 94,
        "tags": ["Digital Pet", "Bandai", "Electronic", "Japan"]
      },
      // Additional items in the category...
    ]
  }
}
```

## Users

### Get All Users
```
GET /api/users
```

**Response:**
```json
{
  "status": "success",
  "results": 5,
  "data": {
    "users": [
      {
        "id": "user-001",
        "username": "nostalgic90skid",
        "birthYear": 1985,
        "location": {
          "country": "United States",
          "region": "California"
        },
        "joinDate": "2023-01-15T08:30:00Z",
        "collection": [
          {
            "itemId": "vg-001",
            "dateAdded": "2023-01-16T14:22:00Z",
            "personalNote": "Spent countless hours collecting stars in this game. The penguin race was my favorite!"
          },
          // Additional collection items...
        ],
        "following": ["user-002", "user-003"],
        "followers": ["user-002", "user-004", "user-005"]
      },
      // Additional users...
    ]
  }
}
```

### Get User by ID
```
GET /api/users/:id
```

**Parameters:**
- `id` - The ID of the user to retrieve

**Response:**
```json
{
  "status": "success",
  "data": {
    "user": {
      "id": "user-001",
      "username": "nostalgic90skid",
      "birthYear": 1985,
      "location": {
        "country": "United States",
        "region": "California"
      },
      "joinDate": "2023-01-15T08:30:00Z",
      "collection": [
        {
          "itemId": "vg-001",
          "dateAdded": "2023-01-16T14:22:00Z",
          "personalNote": "Spent countless hours collecting stars in this game. The penguin race was my favorite!"
        },
        // Additional collection items...
      ],
      "following": ["user-002", "user-003"],
      "followers": ["user-002", "user-004", "user-005"]
    }
  }
}
```

### Get User by Username
```
GET /api/users/username/:username
```

**Parameters:**
- `username` - The username of the user to retrieve

**Response:**
```json
{
  "status": "success",
  "data": {
    "user": {
      "id": "user-001",
      "username": "nostalgic90skid",
      "birthYear": 1985,
      "location": {
        "country": "United States",
        "region": "California"
      },
      "joinDate": "2023-01-15T08:30:00Z",
      "collection": [
        {
          "itemId": "vg-001",
          "dateAdded": "2023-01-16T14:22:00Z",
          "personalNote": "Spent countless hours collecting stars in this game. The penguin race was my favorite!"
        },
        // Additional collection items...
      ],
      "following": ["user-002", "user-003"],
      "followers": ["user-002", "user-004", "user-005"]
    }
  }
}
```

## Authentication

### Login
```
POST /api/users/login
```

**Request Body:**
```json
{
  "email": "nostalgic90s@example.com",
  "password": "password123"
}
```

**Response:**
```json
{
  "status": "success",
  "data": {
    "token": "mock-jwt-token-1741521141903",
    "user": {
      "id": "user-001",
      "username": "nostalgic90skid",
      "email": "nostalgic90s@example.com",
      "birthYear": 1985,
      "location": {
        "country": "United States",
        "region": "California"
      },
      "joinDate": "2023-01-15T08:30:00Z",
      "collection": [
        {
          "itemId": "vg-001",
          "dateAdded": "2023-01-16T14:22:00Z",
          "personalNote": "Spent countless hours collecting stars in this game. The penguin race was my favorite!"
        },
        // Additional collection items...
      ],
      "following": ["user-002", "user-003"],
      "followers": ["user-002", "user-004", "user-005"]
    }
  }
}
```

## Error Responses

### Not Found (404)
```json
{
  "status": "fail",
  "message": "Not Found - /api/invalid-endpoint"
}
```

### Bad Request (400)
```json
{
  "status": "fail",
  "message": "Search query is required"
}
```

### Unauthorized (401)
```json
{
  "status": "fail",
  "message": "Invalid email or password"
}
```

### Server Error (500)
```json
{
  "status": "error",
  "message": "Failed to fetch data",
  "stack": "Error stack trace (only in development mode)"
}
```

## Notes for Frontend Developers

1. All successful responses follow a consistent format:
   - `status`: "success"
   - `data`: Contains the requested data
   - `results`: For list endpoints, indicates the number of items returned

2. Error responses follow a consistent format:
   - `status`: "fail" or "error"
   - `message`: A descriptive error message
   - `stack`: Error stack trace (only in development mode)

3. Authentication:
   - The login endpoint returns a JWT token that should be included in subsequent requests
   - Include the token in the Authorization header: `Authorization: Bearer <token>`

4. The API is currently using mock data, so no actual data persistence is implemented yet
   - All data is loaded from JSON files on server start
   - No POST/PUT/DELETE operations are implemented yet (except for login)

5. All API endpoints are prefixed with `/api` except for the health check endpoint
